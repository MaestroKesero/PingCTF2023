# Write-up: excellent

## Category: rev

## Author essor.

solution.js:

```js
const { bahttext } = require("bahttext");

var encoded = `1337%E0%B8%AA%E0%B8%B5%E0%B9%88%E0%B8%AB%E0%B8%A1%E0%B8%B7%E0%B9%88%E0%B8%99%E0%B8%AA%E0%B8%AD%E0%B8%87%E0%B8%9E%E0%B8%B1%E0%B8%99%E0%B8%AB%E0%B9%89%E0%B8%B2%E0%B8%A3%E0%B9%89%E0%B8%AD%E0%B8%A2%E0%B9%80%E0%B8%88%E0%B9%87%E0%B8%94%E0%B8%AA%E0%B8%B4%E0%B8%9A%E0%B9%80%E0%B8%AD%E0%B9%87%E0%B8%94%E0%B8%9A%E0%B8%B2%E0%B8%97%E0%B8%96%E0%B9%89%E0%B8%A7%E0%B8%990%E0%B8%AB%E0%B8%81%E0%B8%AB%E0%B8%A1%E0%B8%B7%E0%B9%88%E0%B8%99%E0%B8%AA%E0%B8%AD%E0%B8%87%E0%B8%9E%E0%B8%B1%E0%B8%99%E0%B9%80%E0%B8%88%E0%B9%87%E0%B8%94%E0%B8%A3%E0%B9%89%E0%B8%AD%E0%B8%A2%E0%B9%80%E0%B8%88%E0%B9%87%E0%B8%94%E0%B8%AA%E0%B8%B4%E0%B8%9A%E0%B9%80%E0%B8%88%E0%B9%87%E0%B8%94%E0%B8%9A%E0%B8%B2%E0%B8%97%E0%B8%96%E0%B9%89%E0%B8%A7%E0%B8%991%E0%B8%AA%E0%B8%B2%E0%B8%A1%E0%B8%9E%E0%B8%B1%E0%B8%99%E0%B8%AB%E0%B8%99%E0%B8%B6%E0%B9%88%E0%B8%87%E0%B8%A3%E0%B9%89%E0%B8%AD%E0%B8%A2%E0%B8%A2%E0%B8%B5%E0%B9%88%E0%B8%AA%E0%B8%B4%E0%B8%9A%E0%B8%AB%E0%B9%89%E0%B8%B2%E0%B8%9A%E0%B8%B2%E0%B8%97%E0%B8%96%E0%B9%89%E0%B8%A7%E0%B8%992%E0%B8%AB%E0%B8%81%E0%B8%AB%E0%B8%A1%E0%B8%B7%E0%B9%88%E0%B8%99%E0%B8%AA%E0%B8%B5%E0%B9%88%E0%B8%AA%E0%B8%B4%E0%B8%9A%E0%B8%AA%E0%B8%B2%E0%B8%A1%E0%B8%9A%E0%B8%B2%E0%B8%97%E0%B8%96%E0%B9%89%E0%B8%A7%E0%B8%993%E0%B8%AA%E0%B8%B5%E0%B9%88%E0%B8%AB%E0%B8%A1%E0%B8%B7%E0%B9%88%E0%B8%99%E0%B9%80%E0%B8%88%E0%B9%87%E0%B8%94%E0%B8%9E%E0%B8%B1%E0%B8%99%E0%B8%AA%E0%B8%B5%E0%B9%88%E0%B8%A3%E0%B9%89%E0%B8%AD%E0%B8%A2%E0%B8%AB%E0%B8%81%E0%B8%AA%E0%B8%B4%E0%B8%9A%E0%B8%AB%E0%B8%81%E0%B8%9A%E0%B8%B2%E0%B8%97%E0%B8%96%E0%B9%89%E0%B8%A7%E0%B8%994%E0%B8%AA%E0%B8%B2%E0%B8%A1%E0%B8%AB%E0%B8%A1%E0%B8%B7%E0%B9%88%E0%B8%99%E0%B8%AA%E0%B8%AD%E0%B8%87%E0%B8%9E%E0%B8%B1%E0%B8%99%E0%B9%80%E0%B8%88%E0%B9%87%E0%B8%94%E0%B8%A3%E0%B9%89%E0%B8%AD%E0%B8%A2%E0%B9%81%E0%B8%9B%E0%B8%94%E0%B8%AA%E0%B8%B4%E0%B8%9A%E0%B8%AB%E0%B9%89%E0%B8%B2%E0%B8%9A%E0%B8%B2%E0%B8%97%E0%B8%96%E0%B9%89%E0%B8%A7%E0%B8%995%E0%B8%AA%E0%B8%AD%E0%B8%87%E0%B8%AB%E0%B8%A1%E0%B8%B7%E0%B9%88%E0%B8%99%E0%B9%80%E0%B8%81%E0%B9%89%E0%B8%B2%E0%B8%9E%E0%B8%B1%E0%B8%99%E0%B8%AA%E0%B8%AD%E0%B8%87%E0%B8%A3%E0%B9%89%E0%B8%AD%E0%B8%A2%E0%B8%AA%E0%B8%B5%E0%B9%88%E0%B8%AA%E0%B8%B4%E0%B8%9A%E0%B8%AA%E0%B8%B5%E0%B9%88%E0%B8%9A%E0%B8%B2%E0%B8%97%E0%B8%96%E0%B9%89%E0%B8%A7%E0%B8%996%E0%B8%AA%E0%B8%B5%E0%B9%88%E0%B8%9E%E0%B8%B1%E0%B8%99%E0%B8%AB%E0%B8%81%E0%B8%A3%E0%B9%89%E0%B8%AD%E0%B8%A2%E0%B9%81%E0%B8%9B%E0%B8%94%E0%B8%AA%E0%B8%B4%E0%B8%9A%E0%B9%80%E0%B8%AD%E0%B9%87%E0%B8%94%E0%B8%9A%E0%B8%B2%E0%B8%97%E0%B8%96%E0%B9%89%E0%B8%A7%E0%B8%997%E0%B8%AA%E0%B8%B2%E0%B8%A1%E0%B8%AB%E0%B8%A1%E0%B8%B7%E0%B9%88%E0%B8%99%E0%B8%AA%E0%B8%AD%E0%B8%87%E0%B8%9E%E0%B8%B1%E0%B8%99%E0%B8%AA%E0%B8%B2%E0%B8%A1%E0%B8%AA%E0%B8%B4%E0%B8%9A%E0%B9%80%E0%B8%81%E0%B9%89%E0%B8%B2%E0%B8%9A%E0%B8%B2%E0%B8%97%E0%B8%96%E0%B9%89%E0%B8%A7%E0%B8%998%E0%B8%AA%E0%B8%AD%E0%B8%87%E0%B8%AB%E0%B8%A1%E0%B8%B7%E0%B9%88%E0%B8%99%E0%B8%AA%E0%B8%AD%E0%B8%87%E0%B8%9E%E0%B8%B1%E0%B8%99%E0%B8%AA%E0%B8%AD%E0%B8%87%E0%B8%A3%E0%B9%89%E0%B8%AD%E0%B8%A2%E0%B9%80%E0%B8%88%E0%B9%87%E0%B8%94%E0%B8%AA%E0%B8%B4%E0%B8%9A%E0%B8%AB%E0%B9%89%E0%B8%B2%E0%B8%9A%E0%B8%B2%E0%B8%97%E0%B8%96%E0%B9%89%E0%B8%A7%E0%B8%999%E0%B8%AB%E0%B8%99%E0%B8%B6%E0%B9%88%E0%B8%87%E0%B8%AB%E0%B8%A1%E0%B8%B7%E0%B9%88%E0%B8%99%E0%B8%AB%E0%B8%99%E0%B8%B6%E0%B9%88%E0%B8%87%E0%B8%9E%E0%B8%B1%E0%B8%99%E0%B8%AB%E0%B8%99%E0%B8%B6%E0%B9%88%E0%B8%87%E0%B8%A3%E0%B9%89%E0%B8%AD%E0%B8%A2%E0%B9%80%E0%B8%81%E0%B9%89%E0%B8%B2%E0%B8%AA%E0%B8%B4%E0%B8%9A%E0%B8%AB%E0%B9%89%E0%B8%B2%E0%B8%9A%E0%B8%B2%E0%B8%97%E0%B8%96%E0%B9%89%E0%B8%A7%E0%B8%9910%E0%B8%AA%E0%B8%AD%E0%B8%87%E0%B8%AB%E0%B8%A1%E0%B8%B7%E0%B9%88%E0%B8%99%E0%B8%AB%E0%B9%89%E0%B8%B2%E0%B8%9E%E0%B8%B1%E0%B8%99%E0%B8%AA%E0%B8%B2%E0%B8%A1%E0%B8%A3%E0%B9%89%E0%B8%AD%E0%B8%A2%E0%B9%80%E0%B8%81%E0%B9%89%E0%B8%B2%E0%B8%AA%E0%B8%B4%E0%B8%9A%E0%B8%AA%E0%B8%B5%E0%B9%88%E0%B8%9A%E0%B8%B2%E0%B8%97%E0%B8%96%E0%B9%89%E0%B8%A7%E0%B8%9911%E0%B8%AB%E0%B9%89%E0%B8%B2%E0%B8%AB%E0%B8%A1%E0%B8%B7%E0%B9%88%E0%B8%99%E0%B8%AB%E0%B8%99%E0%B8%B6%E0%B9%88%E0%B8%87%E0%B8%9E%E0%B8%B1%E0%B8%99%E0%B9%81%E0%B8%9B%E0%B8%94%E0%B8%A3%E0%B9%89%E0%B8%AD%E0%B8%A2%E0%B8%AA%E0%B8%B5%E0%B9%88%E0%B8%AA%E0%B8%B4%E0%B8%9A%E0%B9%80%E0%B8%81%E0%B9%89%E0%B8%B2%E0%B8%9A%E0%B8%B2%E0%B8%97%E0%B8%96%E0%B9%89%E0%B8%A7%E0%B8%9912%E0%B8%AA%E0%B8%AD%E0%B8%87%E0%B8%9E%E0%B8%B1%E0%B8%99%E0%B8%AA%E0%B8%B5%E0%B9%88%E0%B8%A3%E0%B9%89%E0%B8%AD%E0%B8%A2%E0%B8%AA%E0%B8%B4%E0%B8%9A%E0%B9%80%E0%B8%81%E0%B9%89%E0%B8%B2%E0%B8%9A%E0%B8%B2%E0%B8%97%E0%B8%96%E0%B9%89%E0%B8%A7%E0%B8%9913%E0%B8%AB%E0%B8%99%E0%B8%B6%E0%B9%88%E0%B8%87%E0%B8%AB%E0%B8%A1%E0%B8%B7%E0%B9%88%E0%B8%99%E0%B9%80%E0%B8%88%E0%B9%87%E0%B8%94%E0%B8%AA%E0%B8%B4%E0%B8%9A%E0%B8%AA%E0%B8%B5%E0%B9%88%E0%B8%9A%E0%B8%B2%E0%B8%97%E0%B8%96%E0%B9%89%E0%B8%A7%E0%B8%9914%E0%B8%AA%E0%B8%AD%E0%B8%87%E0%B8%AB%E0%B8%A1%E0%B8%B7%E0%B9%88%E0%B8%99%E0%B8%AA%E0%B8%B2%E0%B8%A1%E0%B8%9E%E0%B8%B1%E0%B8%99%E0%B8%AB%E0%B8%99%E0%B8%B6%E0%B9%88%E0%B8%87%E0%B8%A3%E0%B9%89%E0%B8%AD%E0%B8%A2%E0%B8%AA%E0%B8%B2%E0%B8%A1%E0%B8%AA%E0%B8%B4%E0%B8%9A%E0%B9%80%E0%B8%AD%E0%B9%87%E0%B8%94%E0%B8%9A%E0%B8%B2%E0%B8%97%E0%B8%96%E0%B9%89%E0%B8%A7%E0%B8%9915%E0%B8%AB%E0%B9%89%E0%B8%B2%E0%B8%AB%E0%B8%A1%E0%B8%B7%E0%B9%88%E0%B8%99%E0%B8%AA%E0%B8%AD%E0%B8%87%E0%B8%9E%E0%B8%B1%E0%B8%99%E0%B9%80%E0%B8%81%E0%B9%89%E0%B8%B2%E0%B8%A3%E0%B9%89%E0%B8%AD%E0%B8%A2%E0%B8%A2%E0%B8%B5%E0%B9%88%E0%B8%AA%E0%B8%B4%E0%B8%9A%E0%B8%AA%E0%B8%B2%E0%B8%A1%E0%B8%9A%E0%B8%B2%E0%B8%97%E0%B8%96%E0%B9%89%E0%B8%A7%E0%B8%9916`;

var bahttextMap = [];
for (var i = 0; i < 65535; i++) {
	bahttextMap[bahttext(i)] = i;
}

var flagParts = decodeURIComponent(encoded).split(/[0-9]+/);
flagParts.pop();
flagParts.shift();

values = flagParts.map((a) => bahttextMap[a]);

var lookup = [
	219, 32, 212, 59, 87, 101, 248, 194, 92, 157, 224, 54, 9, 232, 121, 207,
	140, 240, 186, 133, 214, 72, 128, 238, 84, 241, 116, 38, 37, 139, 100, 28,
	78, 0, 130, 183, 82, 188, 12, 95, 53, 178, 104, 119, 213, 204, 245, 118, 13,
	93, 88, 198, 247, 34, 102, 67, 153, 46, 2, 21, 161, 55, 246, 36, 123, 132,
	109, 23, 155, 169, 1, 30, 52, 164, 189, 61, 89, 129, 24, 148, 112, 76, 31,
	126, 22, 77, 17, 218, 15, 223, 210, 146, 107, 105, 182, 33, 206, 253, 184,
	124, 190, 43, 173, 65, 26, 239, 40, 7, 159, 98, 75, 162, 193, 18, 154, 44,
	231, 235, 68, 192, 237, 150, 160, 4, 20, 66, 137, 243, 151, 202, 222, 158,
	138, 39, 45, 58, 175, 115, 48, 252, 156, 227, 94, 50, 106, 187, 81, 83, 47,
	197, 69, 103, 90, 11, 91, 195, 254, 62, 74, 149, 60, 71, 70, 163, 108, 145,
	8, 134, 142, 250, 3, 176, 200, 25, 143, 166, 117, 203, 181, 10, 80, 171, 49,
	201, 51, 236, 63, 42, 255, 209, 6, 152, 73, 167, 217, 111, 5, 226, 56, 170,
	14, 242, 244, 179, 27, 177, 122, 185, 208, 228, 216, 180, 131, 147, 233, 64,
	16, 251, 114, 41, 99, 234, 230, 196, 125, 225, 199, 211, 120, 172, 136, 113,
	168, 215, 220, 144, 191, 19, 229, 141, 96, 57, 165, 85, 35, 79, 174, 97,
	110, 221, 205, 127, 249, 86, 135, 29,
];

var flag = "";

var hash =
	(lookup[("p".charCodeAt(0) ^ 255) - values.length * 2] +
		(lookup[("i".charCodeAt(0) ^ 255) - values.length * 2] << 8)) ^
	values[0];

for (var i = 0; i < values.length; i++) {
	var decrypted = values[i] ^ hash;
	flag += String.fromCharCode(
		(lookup.indexOf(decrypted & 0xff) + values.length * 2) ^ 255
	);
	flag += String.fromCharCode(
		(lookup.indexOf(decrypted >> 8) + values.length * 2) ^ 255
	);
	hash = ((hash * decrypted) ^ hash) & 0xffff;
}

console.log(flag);
```

How creatos compile: ```
gcc  -O3 -msse3 -funroll-loops -mcmodel=large -s gemm.c -o gta6_symbols
```



